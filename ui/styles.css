		      *, *::before, *::after { box-sizing: border-box; }
			      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; font-size: var(--ui-font-size, 14px); margin: 0; background: var(--c-bg, #fff); color: var(--c-text, #0f172a); }
					      :root {
                  --ui-font-size: 14px;
                  --ui-ico-size: 18px;
					        --safe-top: env(safe-area-inset-top, 0px);
					        --safe-right: env(safe-area-inset-right, 0px);
					        --safe-bottom: env(safe-area-inset-bottom, 0px);
					        --safe-left: env(safe-area-inset-left, 0px);

					        --c-bg: #f8fafc;
					        --c-surface: #ffffff;
					        --c-border: rgba(148, 163, 184, .38);
				        --c-border-strong: rgba(148, 163, 184, .55);
				        --c-text: #0f172a;
				        --c-muted: #475569;
				        --c-accent: #0ea5e9;
				        --c-danger: #b91c1c;
				        --c-danger-bg: rgba(254,226,226,.65);
				        --c-soft: rgba(241,245,249,.9);
				        --c-soft-2: rgba(248,250,252,.9);
				        --c-soft-3: rgba(248,250,252,.6);
				        --dock-pad-x: 8px;
				        --dock-pad-x2: 16px;
				        --dock-border-w: 1px;
				        --dock-border-w2: 2px;
					        --dock-bg: rgba(255,255,255,.92);
					        --dock-border: rgba(148,163,184,.28);
				        --shadow-sm: 0 6px 20px rgba(0,0,0,.06);
				        --shadow-md: 0 16px 44px rgba(0,0,0,.10);
				        --shadow-lg: 0 22px 70px rgba(0,0,0,.14);
				        --ring: 0 0 0 3px rgba(14,165,233,.18);

						        /* z-index 量表（避免“随手拉大”导致层级失控） */
						        --z-rightbar: 40;
						        --z-float-nav: 45;
						        --z-bookmarks: 50;
						        --z-bookmark-drawer-overlay: 60;
						        --z-bookmark-drawer: 61;
						        --z-drawer-overlay: 70;
						        --z-drawer: 71;
						        --z-toast: 80;

		        --dock-right: 16px;
				        --rightbar-right: calc(var(--dock-right) + var(--safe-right));
			        --rightbar-w: 38px;
			        --rightbar-gap: 8px;
			        --dock-col-gap: 14px;
			        --content-safe-right: calc(var(--rightbar-w) + 16px);

			        --tabs-bar-h: 44px;
			        --tabs-pad: 5px;
			        --tabs-gap: 5px;
			        --tabs-radius: 14px;
			        --tabs-min-w: 96px;
			        --tabs-max-w: 200px;
		      }

				      body[data-bm-skin="flat"] {
				        --dock-bg: rgba(255,255,255,.96);
				        --dock-border: rgba(148,163,184,.22);
			        --shadow-lg: 0 18px 56px rgba(0,0,0,.12);
			      }
				      body[data-bm-skin="soft"] {
			        --c-bg: #f5f7fb;
			        --c-surface: rgba(255,255,255,.98);
			        --c-border: rgba(148,163,184,.30);
			        --c-border-strong: rgba(148,163,184,.45);
			        --c-accent: #3b82f6;
				        --dock-bg: rgba(255,255,255,.92);
				        --dock-border: rgba(148,163,184,.20);
			        --shadow-sm: 0 10px 26px rgba(0,0,0,.06);
			        --shadow-md: 0 16px 44px rgba(0,0,0,.10);
			      }
				      body[data-bm-skin="contrast"] {
			        --c-bg: #ffffff;
			        --c-surface: #ffffff;
			        --c-border: rgba(15,23,42,.20);
			        --c-border-strong: rgba(15,23,42,.28);
			        --c-text: #0b1020;
			        --c-muted: rgba(30,41,59,.92);
			        --c-accent: #2563eb;
				        --dock-bg: rgba(255,255,255,.98);
				        --dock-border: rgba(15,23,42,.16);
			        --shadow-sm: 0 10px 26px rgba(0,0,0,.07);
			        --shadow-md: 0 18px 52px rgba(0,0,0,.12);
			        --ring: 0 0 0 3px rgba(37,99,235,.18);
			      }
				      body[data-bm-skin="dark"] {
			        --c-bg: #0b1220;
			        --c-surface: #0f172a;
			        --c-border: rgba(148,163,184,.18);
			        --c-border-strong: rgba(148,163,184,.26);
			        --c-text: #e5e7eb;
			        --c-muted: rgba(148,163,184,.95);
			        --c-accent: #38bdf8;
			        --c-danger: #fca5a5;
			        --c-danger-bg: rgba(127,29,29,.55);
			        --c-soft: rgba(30,41,59,.65);
			        --c-soft-2: rgba(15,23,42,.55);
			        --c-soft-3: rgba(30,41,59,.40);
				        --dock-bg: rgba(15,23,42,.88);
				        --dock-border: rgba(148,163,184,.18);
			        --shadow-sm: 0 14px 34px rgba(0,0,0,.32);
			        --shadow-md: 0 22px 56px rgba(0,0,0,.38);
			        --shadow-lg: 0 28px 88px rgba(0,0,0,.44);
			        --ring: 0 0 0 3px rgba(56,189,248,.18);
			      }
		      /* 会话标签栏：底部浏览器标签风格（不遮挡右侧按钮） */
			      #bookmarks {
			        position: fixed;
			        left: calc(16px + var(--safe-left));
			        right: calc(var(--rightbar-right) + var(--rightbar-w) + 12px);
			        bottom: calc(16px + var(--safe-bottom));
			        height: var(--tabs-bar-h);
			        display: flex;
			        align-items: center;
			        justify-content: flex-end;
			        z-index: var(--z-bookmarks);
			        overflow: visible;
			        padding: 0;
			        background: transparent;
			        border: none;
			        box-shadow: none;
			        backdrop-filter: none;
			        pointer-events: none;
			      }
			      #bookmarks .bm-rail {
			        flex: 0 1 auto;
			        display: inline-flex;
			        align-items: center;
			        gap: var(--tabs-gap);
			        height: 100%;
			        width: auto;
			        max-width: 100%;
			        margin-left: auto;
			        padding: 0;
			        border-radius: var(--tabs-radius);
			        border: none;
			        background: transparent;
			        box-shadow: none;
			        overflow-x: auto;
			        overflow-y: hidden;
			        scrollbar-width: thin;
			        scrollbar-color: rgba(148,163,184,.35) transparent;
			        pointer-events: auto;
			      }
			      #bookmarks .bm-rail:empty { display: none; }
			      #bookmarks .bm-rail::-webkit-scrollbar { height: 10px; }
			      #bookmarks .bm-rail::-webkit-scrollbar-thumb {
			        background: rgba(148,163,184,.35);
			        border-radius: 999px;
			        border: 3px solid transparent;
			        background-clip: padding-box;
			      }
			      body[data-bm-skin="dark"] #bookmarks .bm-rail::-webkit-scrollbar-thumb { background: rgba(148,163,184,.22); }
			      .float-nav button.active { background: rgba(2,132,199,.10); border-color: rgba(14,165,233,.55); box-shadow: var(--shadow-sm), var(--ring); }

		      .bookmark {
		        width: auto;
		        min-height: 34px;
		        border: 1px solid rgba(148, 163, 184, .35);
		        background: rgba(255,255,255,.82);
		        border-radius: 12px;
		        cursor: pointer;
		        display: flex;
		        align-items: center;
		        gap: 8px;
		        padding: 6px 10px;
		        text-align: left;
		        position: relative;
		        overflow: hidden;
		        box-shadow: none;
		      }
		      body[data-bm-skin="dark"] .bookmark { background: rgba(15,23,42,.62); border-color: rgba(148,163,184,.22); }
		      .bookmark:hover { background: var(--c-soft-2); }
		      .bookmark .bm-tip { display: none; }
		      .bookmark .bm-dot {
		        width: 10px;
		        height: 10px;
		        border-radius: 999px;
		        background: var(--bm-accent, var(--c-accent));
		        flex: 0 0 auto;
		      }
		      .bookmark .bm-label {
			        font-size: clamp(11px, calc(var(--ui-font-size, 14px) - 2px), 16px);
		        white-space: nowrap;
		        overflow: hidden;
		        text-overflow: ellipsis;
		        color: var(--c-text);
		        flex: 1 1 auto;
		        min-width: 0;
		      }
		      .bookmark.active { background: rgba(2,132,199,.10); border-color: rgba(14,165,233,.55); }
		      body[data-bm-skin="dark"] .bookmark.active { background: rgba(56,189,248,.18); border-color: rgba(56,189,248,.35); }
		      .bookmark.tab-hidden { opacity: .55; filter: saturate(.8); }
		      .bookmark.has-unread::after {
		        content: attr(data-unread);
		        position: absolute;
		        top: 50%;
		        right: 8px;
		        transform: translateY(-50%);
		        min-width: 18px;
		        height: 18px;
		        padding: 0 6px;
		        border-radius: 999px;
		        background: rgba(239, 68, 68, .96);
		        color: #fff;
		        font-size: 11px;
		        line-height: 18px;
		        text-align: center;
		        border: 1px solid rgba(255,255,255,.92);
		        box-shadow: 0 10px 24px rgba(0,0,0,.14);
		      }
		      .bookmark .bm-edit { display:none; width: 100%; padding: 5px 8px; border: 1px solid rgba(14,165,233,.55); border-radius: 10px; outline: none; font-size: 12px; background: var(--c-surface); color: var(--c-text); box-shadow: var(--ring); }
		      .bookmark.editing .bm-label { display:none; }
		      .bookmark.editing .bm-edit { display:block; }

		      /* 标签按钮（tabs） */
		      #bookmarks .bm-rail .bookmark {
		        flex: 0 0 auto;
		        min-width: 0;
		        max-width: min(var(--tabs-max-w), calc(100vw - 120px));
		        height: calc(var(--tabs-bar-h) - 2px);
		        min-height: calc(var(--tabs-bar-h) - 2px);
		        padding: 0 8px;
		        border-radius: 14px;
		        background: rgba(255,255,255,.88);
		        border-color: rgba(148, 163, 184, .35);
		        box-shadow: none;
		      }
		      #bookmarks .bm-rail .bookmark.bm-s { width: 84px; }
		      #bookmarks .bm-rail .bookmark.bm-m { width: 144px; }
		      #bookmarks .bm-rail .bookmark.bm-l { width: 200px; }
		      body[data-bm-skin="dark"] #bookmarks .bm-rail .bookmark { background: rgba(15,23,42,.58); border-color: rgba(148,163,184,.20); }
		      #bookmarks .bm-rail .bookmark:hover { background: var(--c-soft-2); border-color: var(--c-border); }
		      #bookmarks .bm-rail .bookmark.active {
		        background: var(--c-surface);
		        border-color: rgba(14,165,233,.55);
		        box-shadow: var(--shadow-sm);
		      }
		      body[data-bm-skin="dark"] #bookmarks .bm-rail .bookmark.active { background: rgba(15,23,42,.82); }
		      #bookmarks .bm-rail .bookmark .bm-dot { width: 4px; height: 18px; border-radius: 999px; }
			      #bookmarks .bm-rail .bookmark .bm-label { font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 1px), 18px); }
		      #bookmarks .bm-rail .bookmark .bm-tip { display: none; }
		      #bookmarks .bm-rail .bookmark .bm-close {
		        width: 22px;
		        height: 22px;
		        border-radius: 8px;
		        border: 1px solid transparent;
		        background: transparent;
		        color: var(--c-muted);
		        cursor: pointer;
		        display:flex;
		        align-items:center;
		        justify-content:center;
		        opacity: 0;
		        flex: 0 0 auto;
		        transition: opacity .12s ease;
		      }
		      #bookmarks .bm-rail .bookmark[data-key="all"] .bm-close { display: none; }
		      #bookmarks .bm-rail .bookmark:hover .bm-close,
		      #bookmarks .bm-rail .bookmark.active .bm-close { opacity: .9; }
		      #bookmarks .bm-rail .bookmark .bm-close:hover { background: var(--c-soft); border-color: var(--c-border); color: var(--c-text); }
		      #bookmarks .bm-rail .bookmark.editing .bm-close { display: none; }
		      #bookmarks .bm-rail .bookmark.has-unread::after { right: 30px; }
		      #bookmarks .bm-rail .bookmark[data-key="all"].has-unread::after { right: 8px; }

					      #main { margin: 16px; padding-bottom: calc(16px + var(--safe-bottom) + var(--tabs-bar-h) + 10px); padding-right: var(--content-safe-right); }
		      .row { border: 1px solid var(--c-border); border-left: 4px solid rgba(148, 163, 184, .55); border-radius: 12px; padding: 12px; margin: 10px 0; background: var(--c-surface); box-shadow: var(--shadow-sm); }
			      #topbar.row { border: none; border-radius: 0; background: transparent; box-shadow: none; padding: 0; margin: 14px 0 14px; display:flex; align-items:center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
			      #topbar .top-title { font-size: calc(var(--ui-font-size, 14px) + 4px); font-weight: 900; }
	      .row.kind-user_message { border-left-color:#38bdf8; }
	      .row.kind-assistant_message { border-left-color:#4ade80; }
	      .row.kind-tool_call, .row.kind-tool_output { border-left-color:#fbbf24; }
	      .row.kind-tool_gate { border-left-color:#f87171; }
	      .row.kind-reasoning_summary { border-left-color:#c4b5fd; }
		      .meta { color: var(--c-muted); font-size: clamp(11px, calc(var(--ui-font-size, 14px) - 2px), 16px); }
	      .meta-link { color: var(--c-accent); text-decoration: none; }
	      .meta-link:hover { text-decoration: underline; }
	      .meta-line { display:flex; align-items:center; gap:8px; }
		      .meta-left { display:flex; align-items:center; gap:8px; flex-wrap:wrap; min-width: 0; }
		      .meta-right { margin-left:auto; display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
		      .meta-line .timestamp { font-variant-numeric: tabular-nums; }
			      .status-text { position: relative; max-width: 56vw; text-align: right; cursor: default; padding: 4px 10px; border: 1px solid var(--c-border); border-radius: 999px; background: var(--c-soft-2); color: var(--c-text); }
			      .status-hover {
			        position: absolute;
			        right: 0;
			        top: calc(100% + 8px);
			        min-width: 260px;
			        max-width: 420px;
			        max-height: 52vh;
			        overflow: auto;
			        padding: 10px 12px;
		        border-radius: 14px;
		        border: 1px solid var(--c-border);
		        background: rgba(255,255,255,.98);
		        box-shadow: var(--shadow-lg);
		        color: var(--c-text);
		        font-size: 12px;
		        text-align: left;
		        line-height: 1.45;
		        user-select: text;
		        opacity: 0;
		        pointer-events: none;
		        transform: translateY(-4px);
		        transition: opacity .12s ease, transform .12s ease;
		        z-index: calc(var(--z-rightbar) + 3);
		      }
		      body[data-bm-skin="dark"] .status-hover {
		        background: rgba(15,23,42,.94);
		        color: rgba(226,232,240,.98);
		        border-color: rgba(148,163,184,.22);
		      }
		      .status-text:hover .status-hover,
		      .status-text:focus-within .status-hover { opacity: 1; transform: translateY(0); pointer-events: auto; }
		      .status-hover .sh-head { display:flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start; margin-bottom: 8px; }
		      .status-hover .sh-chip { display:inline-flex; align-items:center; gap:6px; padding: 4px 8px; border-radius: 999px; border: 1px solid var(--c-border); background: var(--c-soft-2); color: var(--c-text); }
		      .status-hover .sh-chip code { background: transparent; border: none; padding: 0; }
		      .status-hover .sh-muted { opacity: .72; }
		      .status-hover .sh-sec { margin-top: 10px; }
		      .status-hover .sh-title { font-weight: 900; font-size: 12px; color: var(--c-text); display:flex; align-items:center; justify-content: space-between; gap: 10px; }
		      .status-hover .sh-count { font-variant-numeric: tabular-nums; opacity: .75; }
			      .status-hover .sh-list { margin-top: 6px; display:flex; flex-direction: column; gap: 8px; }
			      .status-hover .sh-list-clean { margin-top: 8px; }
			      .status-hover .sh-item { display:flex; align-items:center; gap: 10px; padding: 8px 10px; border-radius: 12px; border: 1px solid var(--c-border); background: var(--c-soft-2); }
			      body[data-bm-skin="dark"] .status-hover .sh-item { background: rgba(30,41,59,.55); border-color: rgba(148,163,184,.22); }
			      .status-hover .sh-tag { font-variant-numeric: tabular-nums; font-weight: 900; opacity: .75; }
			      .status-hover .sh-stamp { font-variant-numeric: tabular-nums; white-space: nowrap; }
			      .status-hover .sh-id { margin-left: auto; opacity: .9; }
			      .status-hover .sh-id code { background: transparent; border: none; padding: 0; }
			      .status-hover .sh-empty { color: var(--c-muted); }
			      .status-hover .sh-error { margin-bottom: 10px; padding: 8px 10px; border-radius: 12px; border: 1px solid rgba(239,68,68,.35); background: rgba(254,226,226,.65); color: #7f1d1d; }
			      body[data-bm-skin="dark"] .status-hover .sh-error { background: rgba(127,29,29,.45); border-color: rgba(248,113,113,.35); color: rgba(254,226,226,.95); }
			      .status-hover .sh-details { margin-top: 10px; }
			      .status-hover .sh-details summary { cursor: pointer; color: var(--c-muted); font-size: 12px; }
			      .status-hover .sh-details-body { margin-top: 6px; }
	      pre { white-space: pre-wrap; word-break: break-word; margin: 8px 0 0; }
		      .badge { display:inline-block; padding:2px 8px; border-radius:999px; border: 1px solid var(--c-border); background: var(--c-soft); color: var(--c-muted); font-size: clamp(11px, calc(var(--ui-font-size, 14px) - 2px), 16px); margin-right:8px; font-weight: 700; }
	      .badge.kind-user_message, .badge.kind-user { background: rgba(224,242,254,.9); border-color: rgba(56,189,248,.35); color: #075985; }
	      .badge.kind-assistant_message, .badge.kind-assistant { background: rgba(220,252,231,.9); border-color: rgba(34,197,94,.30); color: #166534; }
      .badge.kind-tool_call, .badge.kind-tool_output { background: rgba(254,249,195,.9); border-color: rgba(251,191,36,.35); color: #92400e; }
	      body[data-bm-skin="dark"] .badge.kind-user_message,
	      body[data-bm-skin="dark"] .badge.kind-user { background: rgba(56,189,248,.14); border-color: rgba(56,189,248,.28); color: #7dd3fc; }
	      body[data-bm-skin="dark"] .badge.kind-assistant_message,
	      body[data-bm-skin="dark"] .badge.kind-assistant { background: rgba(34,197,94,.14); border-color: rgba(34,197,94,.25); color: #86efac; }
	      body[data-bm-skin="dark"] .badge.kind-tool_call,
	      body[data-bm-skin="dark"] .badge.kind-tool_output { background: rgba(251,191,36,.14); border-color: rgba(251,191,36,.25); color: #fde68a; }
		      .tabs { display:flex; flex-direction:column; gap:6px; margin: 10px 0 0; }
		      .tab { border: 1px solid var(--c-border); background: var(--c-surface); padding: 8px 10px; border-radius: 12px; cursor:pointer; font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 2px), 16px); text-align:left; width: 100%; display:flex; align-items:center; gap:8px; position: relative; overflow: visible; }
		      body[data-bm-skin="dark"] .tab { background: rgba(15,23,42,.58); border-color: rgba(148,163,184,.22); }
		      .tab:hover { background: var(--c-soft-2); }
		      .tab.active { border-color: rgba(14,165,233,.55); box-shadow: var(--ring); }
		      .tab-main { flex: 1 1 auto; min-width: 0; overflow: hidden; display:flex; flex-direction:column; gap: 2px; }
		      .tab .tab-label { display:block; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
		      .tab .tab-sub { display:block; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; color: var(--c-muted); opacity: .9; }
		      body[data-bm-skin="dark"] .tab .tab-sub { color: rgba(148,163,184,.92); }
		      .tab .tab-edit { display:none; flex: 1 1 auto; min-width: 0; padding: 6px 8px; border: 1px solid rgba(14,165,233,.55); border-radius: 10px; outline: none; font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 2px), 16px); background: var(--c-surface); color: var(--c-text); box-shadow: var(--ring); }
		      .tab.editing .tab-label { display:none; }
		      .tab.editing .tab-edit { display:block; }
	      .tab-actions { margin-left: auto; display:flex; gap:6px; align-items:center; }
	      .tab.has-unread::after {
	        content: attr(data-unread);
	        position: absolute;
	        top: -6px;
	        right: -6px;
	        min-width: 18px;
	        height: 18px;
	        padding: 0 5px;
	        border-radius: 999px;
	        background: rgba(239, 68, 68, .96);
	        color: #fff;
	        font-size: 11px;
	        line-height: 18px;
	        text-align: center;
	        border: 1px solid rgba(255,255,255,.92);
	        box-shadow: 0 10px 24px rgba(0,0,0,.14);
	      }
	      .tab-dot { width: 10px; height: 10px; border-radius: 999px; display:inline-block; flex: 0 0 auto; }
		      .top-title { font-size: calc(var(--ui-font-size, 14px) + 4px); font-weight: 800; }
			      .rightbar {
			        position: fixed;
			        right: var(--rightbar-right);
			        top: calc(16px + var(--safe-top));
			        bottom: auto;
			        transform: none;
			        display: flex;
			        flex-direction: column;
			        gap: var(--rightbar-gap);
			        z-index: var(--z-rightbar);
			        max-height: calc(100vh - 32px);
			        overflow: visible;
			        padding: 0;
			        background: transparent;
			        border: none;
			        box-shadow: none;
			        backdrop-filter: none;
			      }
		      .rightbar .icon-btn { box-shadow: none; }
		      .icon-btn { width: var(--rightbar-w); height: var(--rightbar-w); padding: 0; border-radius: 999px; display:flex; align-items:center; justify-content:center; border: 1px solid var(--c-border); background: var(--c-surface); color: var(--c-text); cursor:pointer; box-shadow: var(--shadow-sm); font-size: 16px; line-height: 1; }
		      .icon-btn:hover { background: var(--c-soft-2); }
		      .icon-btn:active { transform: translateY(1px); }
		      .icon-btn:focus-visible { outline: none; box-shadow: var(--shadow-sm), var(--ring); border-color: rgba(14,165,233,.55); }
		      .icon-btn.active { background: rgba(2,132,199,.10); color: var(--c-text); border-color: rgba(14,165,233,.55); }
		      .rightbar .icon-btn { position: relative; }
		      .rightbar .icon-btn::after {
		        content: attr(aria-label);
		        position: absolute;
		        right: calc(100% + 10px);
		        top: 50%;
		        transform: translateY(-50%) translateX(4px);
		        padding: 6px 10px;
		        border-radius: 999px;
		        border: 1px solid rgba(148,163,184,.35);
		        background: rgba(255,255,255,.96);
		        color: var(--c-text);
		        font-size: 12px;
		        white-space: nowrap;
		        box-shadow: var(--shadow-sm);
		        opacity: 0;
		        pointer-events: none;
		        transition: opacity .12s ease, transform .12s ease;
		        z-index: calc(var(--z-rightbar) + 5);
		      }
		      body[data-bm-skin="dark"] .rightbar .icon-btn::after {
		        background: rgba(15,23,42,.92);
		        color: rgba(226,232,240,.98);
		        border-color: rgba(148,163,184,.22);
		      }
		      .rightbar .icon-btn:hover::after,
		      .rightbar .icon-btn:focus-visible::after { opacity: 1; transform: translateY(-50%) translateX(0); }

		      #translateToggleBtn { position: relative; }
		      #translateToggleBtn::before {
		        content: "";
		        position: absolute;
		        bottom: 6px;
		        right: 6px;
		        width: 16px;
		        height: 16px;
		        border-radius: 999px;
		        background: rgba(148,163,184,.92);
		        border: 1px solid rgba(148,163,184,.55);
		        box-shadow: 0 6px 14px rgba(0,0,0,.10);
		        display:flex;
		        align-items:center;
		        justify-content:center;
		        font-size: 10px;
		        font-weight: 900;
		        line-height: 1;
		        color: rgba(15,23,42,.78);
		        content: attr(data-mode);
		      }
		      #translateToggleBtn.active::before {
		        background: rgba(34,197,94,.95);
		        border-color: rgba(34,197,94,.55);
		        color: #fff;
		      }
		      #translateToggleBtn.active { background: rgba(34,197,94,.14); border-color: rgba(34,197,94,.55); }
		      #translateToggleBtn.active:hover { background: rgba(34,197,94,.18); }
	      .icon-btn:disabled { opacity: .45; cursor: not-allowed; box-shadow: none; }
		      .icon-btn.danger { background: var(--c-surface); border-color: rgba(248,113,113,.45); color: var(--c-danger); }
		      .icon-btn.danger:hover { background: var(--c-danger-bg); }
		      @media (max-height: 640px) {
		        .rightbar { top: calc(12px + var(--safe-top)); }
		      }
	      .grid { display:grid; grid-template-columns: 140px 1fr; gap: 6px 10px; align-items:center; margin-top: 10px; }
	      .grid.grid-compact { grid-template-columns: 110px 1fr; gap: 6px 8px; margin-top: 8px; }
			      .grid input, .grid select { width: 100%; padding: 6px 8px; border: 1px solid var(--c-border); border-radius: 10px; background: var(--c-surface); color: var(--c-text); }
	      .grid input[type="checkbox"] { width: auto; padding: 0; border: none; box-shadow: none; accent-color: var(--c-accent); }
		      .grid.grid-compact input, .grid.grid-compact select { padding: 5px 8px; border-radius: 10px; }
	      .check-row { display:flex; flex-wrap:wrap; gap: 12px; align-items:center; }
	      .check { display:inline-flex; align-items:center; gap: 6px; cursor: pointer; user-select: none; font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 2px), 16px); }
	      .check input[type="checkbox"] { width: 16px; height: 16px; margin: 0; }
		      .unit-field { display:flex; align-items:center; gap: 8px; }
		      .unit-field input { flex: 1 1 auto; min-width: 0; }
		      .unit-field .unit { color: var(--c-muted); font-size: clamp(11px, calc(var(--ui-font-size, 14px) - 2px), 16px); white-space: nowrap; }
		      .grid input:focus, .grid select:focus { outline: none; border-color: rgba(14,165,233,.55); box-shadow: var(--ring); }
	      .field-invalid { border-color: rgba(248,113,113,.55) !important; box-shadow: 0 0 0 3px rgba(248,113,113,.18) !important; }
	      .form-error { color: var(--c-danger); }
	      .form-error:empty { display: none; }
      .btns { display:flex; gap: 8px; flex-wrap:wrap; margin-top: 10px; }
		      button { border: 1px solid var(--c-border); background: var(--c-surface); color: var(--c-text); padding: 7px 10px; border-radius: 10px; cursor:pointer; box-shadow: 0 1px 0 rgba(15,23,42,.04); }
	      button:hover { background: var(--c-soft-2); }
	      button:active { transform: translateY(1px); }
	      button:focus-visible { outline: none; box-shadow: var(--ring); border-color: rgba(14,165,233,.55); }
      button.primary { background:#111827; color:#fff; border-color:#111827; }
		      button.danger { background: var(--c-danger-bg); border-color: rgba(248,113,113,.45); color: var(--c-danger); }
		      .muted { opacity: .8; }
		      .float-nav { position: fixed; right: var(--rightbar-right); left: auto; bottom: calc(16px + var(--safe-bottom)); display:flex; flex-direction:column; gap: var(--rightbar-gap); z-index: var(--z-float-nav); }
		      .float-nav button { width: var(--rightbar-w); height: var(--rightbar-w); padding: 0; border-radius: 999px; box-shadow: var(--shadow-sm); border: 1px solid var(--c-border); background: var(--c-surface); color: var(--c-text); display:flex; align-items:center; justify-content:center; cursor:pointer; }
			      .float-nav button:hover { background: var(--c-soft-2); }
	      #scrollBottomBtn.has-unread { position: relative; }
	      #scrollBottomBtn.has-unread::after {
	        content: attr(data-unread);
	        position: absolute;
	        top: -6px;
	        right: -6px;
	        min-width: 18px;
	        height: 18px;
	        padding: 0 5px;
	        border-radius: 999px;
	        background: rgba(239, 68, 68, .96);
	        color: #fff;
	        font-size: 11px;
	        line-height: 18px;
	        text-align: center;
	        border: 1px solid rgba(255,255,255,.92);
	        box-shadow: 0 10px 24px rgba(0,0,0,.14);
	      }
				      .drawer-overlay { position: fixed; inset: 0; background: rgba(15,23,42,.18); z-index: var(--z-drawer-overlay); }
				      .drawer { position: fixed; top: calc(16px + var(--safe-top)); right: var(--rightbar-right); bottom: auto; width: 380px; max-width: calc(100vw - 32px - var(--safe-left) - var(--safe-right)); max-height: calc(100vh - 32px - var(--safe-top) - var(--safe-bottom)); background: var(--c-surface); border: none; border-radius: 12px; padding: 10px; overflow: auto; z-index: var(--z-drawer); box-shadow: var(--shadow-md); }
		      #bookmarkDrawerOverlay { z-index: var(--z-bookmark-drawer-overlay); background: rgba(15,23,42,.08); }
			      #bookmarkDrawer {
			        z-index: var(--z-bookmark-drawer);
			        top: auto;
			        left: auto;
			        right: calc(var(--rightbar-right) + var(--rightbar-w) + 12px);
			        bottom: calc(16px + var(--safe-bottom) + var(--tabs-bar-h) + 10px);
			        width: min(380px, calc(100vw - 32px - var(--safe-left) - var(--safe-right)));
			        max-height: min(70vh, calc(100vh - 32px - var(--safe-top) - var(--safe-bottom) - var(--tabs-bar-h) - 16px));
			        overflow-x: hidden;
			        overflow-y: auto;
			      }
			      #translateDrawer {
			        width: min(520px, calc(100vw - 32px - var(--safe-left) - var(--safe-right)));
			        overflow-x: hidden;
			        overflow-y: auto;
			      }
			      #translateDrawer .drawer-sec { overflow-x: hidden; }
			      #translateDrawer .profile-row { min-width: 0; flex-wrap: wrap; }
			      #translateDrawer .profile-row > * { min-width: 0; }
			      .drawer-head { display:flex; align-items:center; justify-content:space-between; gap:8px; }
			      .drawer-head .title { font-weight: 700; }
				      .drawer-close { border:none; background: transparent; color: var(--c-text); border-radius: 10px; width: 34px; height: 34px; padding: 0; font-size: 18px; line-height: 1; cursor:pointer; box-shadow: none; }
				      .drawer-close:hover { background: var(--c-soft-2); }
				      .drawer-close:active { transform: translateY(1px); }
				      .drawer-close:focus-visible { outline: none; box-shadow: var(--shadow-sm), var(--ring); border-color: rgba(14,165,233,.55); }
				      .drawer-sec { margin-top: 10px; border: none; border-radius: 0; background: transparent; padding: 0; }
      .drawer-details { margin-top: 10px; }
      .drawer-details > summary { cursor:pointer; font-weight: 700; color: var(--c-muted); list-style: none; }
      .drawer-details > summary.drawer-subtitle { font-weight: 900; color: var(--c-text); font-size: 13px; }
      .drawer-details > summary::-webkit-details-marker { display: none; }
      .drawer-details[open] > summary { color: var(--c-text); }
      .drawer-details .grid { margin-top: 8px; }

			      .drawer-sec > summary { cursor:pointer; font-weight: 700; color:#0f172a; list-style: none; }
				      .drawer-sec > summary::-webkit-details-marker { display: none; }
				      .drawer-sec[open] > summary { margin-bottom: 6px; }
				      .confirm-dialog { border: 1px solid var(--c-border); border-radius: 14px; padding: 0; width: min(420px, calc(100vw - 32px - var(--safe-left) - var(--safe-right))); background: var(--c-surface); color: var(--c-text); box-shadow: var(--shadow-md); }
				      .confirm-dialog::backdrop { background: rgba(15,23,42,.22); }
				      .confirm-dialog-form { padding: 12px 12px 10px; }
				      .confirm-dialog-title { font-weight: 900; }
				      .confirm-dialog-desc { margin-top: 8px; }
				      .tool-card { background: var(--c-soft-2); border: 1px solid var(--c-border); border-radius: 10px; padding: 10px; margin-top: 8px; }
		      .tool-head { display:flex; align-items:center; justify-content:space-between; gap:8px; }
		      .tool-actions { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
		      .tool-toggle { border: 1px solid var(--c-border); background: var(--c-surface); padding: 2px 8px; border-radius: 999px; cursor:pointer; font-size: 12px; color: var(--c-muted); box-shadow: 0 1px 0 rgba(15,23,42,.04); }
			      .tool-toggle:hover { background: var(--c-soft); }
			      .tool-toggle:active { transform: translateY(1px); }
			      .tool-toggle:focus-visible { outline: none; box-shadow: var(--ring); border-color: rgba(14,165,233,.55); }
	      .tool-details { margin-top: 8px; }
	      .hidden { display: none; }
		      .pill { display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid var(--c-border); background: var(--c-surface); font-size:12px; }
	      button.pill { font-family: inherit; line-height: 1.2; }
	      .pill-btn { appearance: none; -webkit-appearance: none; cursor: pointer; }
		      .pill-btn:hover { background: var(--c-soft); }
	      .pill-btn:active { transform: translateY(1px); }
	      .pill-btn:disabled { opacity: .55; cursor: default; transform: none; }
		      .tool-meta { display:flex; flex-wrap:wrap; gap:10px; margin-top: 6px; color: var(--c-muted); font-size: 12px; }
	      .pre-wrap { position: relative; }
	      .copy-btn { position:absolute; top: -10px; right: 6px; width: 22px; height: 22px; padding: 0; border-radius: 999px; font-size: 13px; line-height: 1; display:flex; align-items:center; justify-content:center; border: 1px solid rgba(148,163,184,.45); background: rgba(15,23,42,.78); color:#e2e8f0; cursor:pointer; opacity: 0; transition: opacity .15s; }
	      .copy-btn.light { background: rgba(255,255,255,.85); color:#0f172a; border-color:#e2e8f0; }
	      .pre-wrap:hover .copy-btn { opacity: 1; }
	      .copy-btn:active { transform: translateY(1px); }
	      @keyframes copyToastFade {
	        0% { opacity: 0; transform: translateY(-6px) scale(.98); }
	        12% { opacity: 1; transform: translateY(0) scale(1); }
	        78% { opacity: 1; }
	        100% { opacity: 0; transform: translateY(-8px) scale(.98); }
	      }
	      @keyframes cornerToastIn {
	        0% { opacity: 0; transform: translateY(8px) scale(.98); }
	        12% { opacity: 1; transform: translateY(0) scale(1); }
	        100% { opacity: 1; }
	      }
	      .copy-toast { position:absolute; top: -10px; right: 34px; padding: 4px 10px; border-radius: 999px; font-size: 12px; line-height: 1; background: rgba(15,23,42,.72); color:#e2e8f0; border: 1px solid rgba(148,163,184,.35); box-shadow: 0 10px 24px rgba(0,0,0,.14); pointer-events:none; animation: copyToastFade 1.2s ease forwards; }
	      .copy-toast.light { background: rgba(255,255,255,.92); color:#0f172a; border-color:#e2e8f0; }
		      .copy-toast.fixed { position: fixed; top: var(--safe-top); left: var(--safe-left); right: auto; z-index: var(--z-toast); }
		      .corner-notify { position: fixed; right: calc(64px + var(--safe-right)); bottom: calc(16px + var(--safe-bottom)); z-index: var(--z-toast); display:flex; flex-direction:column; gap: 8px; pointer-events:none; }
	      .corner-toast { pointer-events:none; min-width: 220px; max-width: min(460px, calc(100vw - 28px - 64px)); padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(148,163,184,.35); background: rgba(15,23,42,.92); color:#e2e8f0; box-shadow: 0 16px 44px rgba(0,0,0,.22); animation: cornerToastIn .16s ease-out forwards; }
	      .corner-toast.info { border-color: rgba(148,163,184,.35); }
	      .corner-toast.warn { border-color: rgba(248,113,113,.55); background: rgba(127,29,29,.86); }
	      .corner-toast.success { border-color: rgba(34,197,94,.5); background: rgba(20,83,45,.86); }
	      .corner-title { font-size: 12px; font-weight: 800; color:#f8fafc; }
	      .corner-detail { margin-top: 4px; font-size: 12px; color:#e2e8f0; opacity: .95; white-space: pre-wrap; word-break: break-word; }
		      pre.code { background:#0b1020; color:#e5e7eb; padding: 10px; border-radius: 10px; overflow:auto; white-space: pre; word-break: normal; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 2px), 16px); line-height: 1.35; }
      pre.code { cursor: pointer; }
      pre.code.copied { outline: 2px solid rgba(34,197,94,.35); box-shadow: 0 0 0 4px rgba(34,197,94,.14); }
      pre.code .diff-line { display:block; padding: 0 6px; border-radius: 6px; }
      pre.code .diff-add { background: rgba(34, 197, 94, .16); }
      pre.code .diff-del { background: rgba(239, 68, 68, .16); }
      pre.code .diff-ellipsis { color:#cbd5e1; background: rgba(59, 130, 246, .12); }
	      .change-head { display:flex; flex-wrap:wrap; align-items:center; gap:8px; }
	      /* Markdown typography (Typora-ish) */
		      .md {
		        font-size: var(--ui-font-size, 14px);
		        line-height: 1.75;
		        color: var(--c-text);
		        text-wrap: pretty;
		        overflow-wrap: anywhere;
		      }
	      .md h1, .md h2, .md h3 {
	        margin: 12px 0 6px;
	        line-height: 1.25;
	        font-weight: 900;
	        text-wrap: balance;
	      }
		      .md h1 { font-size: 1.28em; margin-top: 14px; }
		      .md h2 { font-size: 1.14em; margin-top: 14px; }
		      .md h3 { font-size: 1.00em; margin-top: 12px; }
	      .md p { margin: 8px 0; }
	      .md p:first-child { margin-top: 0; }
	      .md p:last-child { margin-bottom: 0; }
	      .md ul { margin: 8px 0 8px 18px; padding: 0; }
	      .md ol { margin: 8px 0 8px 20px; padding: 0; }
	      .md li { margin: 4px 0; }
	      .md li::marker { color: rgba(71,85,105,.88); }
	      body[data-bm-skin="dark"] .md li::marker { color: rgba(148,163,184,.92); }
	      .md strong { font-weight: 900; }
	      .md a { color: var(--c-accent); text-decoration: underline; text-underline-offset: 2px; text-decoration-thickness: 1px; }
	      .md a:hover { text-decoration-thickness: 2px; }
		      .md code {
		        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
		        font-size: clamp(12px, calc(var(--ui-font-size, 14px) - 2px), 16px);
		        background: var(--c-soft);
		        border: 1px solid var(--c-border);
		        padding: 1px 6px;
		        border-radius: 6px;
		      }
	      .md pre code { background: transparent; padding: 0; }
	      .md blockquote {
	        margin: 10px 0;
	        padding: 10px 12px;
	        border-left: 3px solid var(--c-border-strong);
	        background: var(--c-soft-3);
	        border-radius: 12px;
	        color: var(--c-text);
	      }
	      .md blockquote > :first-child { margin-top: 0; }
	      .md blockquote > :last-child { margin-bottom: 0; }
		      /* Math (KaTeX) */
		      .md .katex {
		        max-width: 100%;
		        overflow-x: auto;
		        overflow-y: hidden;
		        font-size: 1.06em;
		        -webkit-font-smoothing: antialiased;
		        -moz-osx-font-smoothing: grayscale;
		      }
		      .md .katex-display {
		        max-width: 100%;
		        overflow-x: auto;
		        overflow-y: hidden;
		        margin: 10px 0;
		        font-size: 1.08em;
		      }
	      .md .md-sep { margin: 10px 0; color:#cbd5e1; }
	        .md-table { margin: 8px 0 0; overflow-x: auto; border: 1px solid var(--c-border); border-radius: 10px; background: var(--c-surface); }
        .md-table table { border-collapse: collapse; width: 100%; min-width: 420px; }
	        .md-table th, .md-table td { border-top: 1px solid var(--c-border); border-left: 1px solid var(--c-border); padding: 6px 8px; vertical-align: top; }
        .md-table th:first-child, .md-table td:first-child { border-left: none; }
	        .md-table thead th { background: var(--c-soft-2); font-weight: 800; color: var(--c-text); }
	        .md-table tbody tr:nth-child(even) td { background: var(--c-soft-3); }
		      .think-split { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--c-border); }
	      .row.think-mode-en .think-zh { display: none; }
	      .row.think-mode-en .think-wait { display: none; }
	      .row.think-mode-zh .think-en { display: none; }
	      body.quick-view .row:not(#topbar):not(.row-empty):not(.kind-user_message):not(.kind-assistant_message):not(.kind-reasoning_summary):not(.tool-update_plan) { display: none; }

	      @media (prefers-reduced-motion: reduce) {
	        html:focus-within { scroll-behavior: auto; }
	        #bookmarks { transition: none; }
	        .status-hover { transition: none; transform: none; }
	        .corner-toast { animation: none; }
	      }

	      @media (pointer: coarse) {
	        :root { --rightbar-w: 44px; --rightbar-gap: 10px; }
	        .bookmark { min-height: 44px; }
	        #bookmarks .bm-rail { padding: 10px 8px; border-radius: 18px; }
	        #bookmarks .bm-rail .bookmark { height: 40px; min-height: 40px; }
	      }
	      .profile-row { display:flex; gap: 6px; align-items:center; }
		      .mini-btn { position: relative; width: 30px; height: 30px; padding: 0; border-radius: 10px; border: 1px solid var(--c-border); background: var(--c-surface); color: var(--c-text); cursor:pointer; display:flex; align-items:center; justify-content:center; font-size: 14px; line-height: 1; box-shadow: 0 1px 0 rgba(15,23,42,.04); }
		      .mini-btn:hover { background: var(--c-soft); }
		      .mini-btn:active { transform: translateY(1px); }
		      .mini-btn:focus-visible { outline: none; box-shadow: var(--ring); border-color: rgba(14,165,233,.55); }
		      .mini-btn.active { background: rgba(2,132,199,.10); color: var(--c-text); border-color: rgba(14,165,233,.55); }
		      .mini-btn.danger { border-color: rgba(248,113,113,.45); color: var(--c-danger); }
		      .mini-btn.danger:hover { background: var(--c-danger-bg); }
		      .mini-btn[aria-label]::after {
		        content: attr(aria-label);
		        position: absolute;
		        left: 50%;
		        top: calc(100% + 6px);
		        transform: translateX(-50%) translateY(-2px);
		        padding: 6px 10px;
		        border-radius: 999px;
		        border: 1px solid rgba(148,163,184,.35);
		        background: rgba(255,255,255,.96);
		        color: var(--c-text);
		        font-size: 12px;
		        white-space: nowrap;
		        box-shadow: var(--shadow-sm);
		        opacity: 0;
		        pointer-events: none;
		        transition: opacity .12s ease, transform .12s ease;
		        z-index: calc(var(--z-drawer) + 5);
		      }
		      body[data-bm-skin="dark"] .mini-btn[aria-label]::after {
		        background: rgba(15,23,42,.92);
		        color: rgba(226,232,240,.98);
		        border-color: rgba(148,163,184,.22);
		      }
		      .mini-btn:hover::after,
		      .mini-btn:focus-visible::after { opacity: 1; transform: translateX(-50%) translateY(0); }
	      .tab.tab-hidden { opacity: .55; filter: saturate(.8); }
	      .ico { width: var(--ui-ico-size, 18px); height: var(--ui-ico-size, 18px); display:block; stroke: currentColor; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; pointer-events:none; }
