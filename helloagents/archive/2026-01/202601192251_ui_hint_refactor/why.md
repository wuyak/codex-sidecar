# 变更提案: UI 提示系统统一与会话管理整改

## 需求背景

当前 UI 存在多种提示机制并行（CSS tooltip / `title` 原生提示 / toast 浮动提示），导致：

1. 同一按钮悬停时出现重复提示（双信息栏）
2. 标签页悬停提示被滥用且可能叠加（一次悬停出现两条浮动提示）
3. 会话管理抽屉中“切换会话”类提示干扰阅读
4. 导出按钮的“角标/状态”未按设计表现，出现不美观的失败样式
5. 部分弹层层级与内容冗余（导出设置遮挡与“当前会话”信息）

本次整改以 `修改意见整理/修改意见整理.md` 为唯一需求来源，逐条对齐配图效果。

## 变更内容

1. **统一提示系统（方案2）**
   - 以 `aria-label` + CSS tooltip 为主，去除 `title` 与 hover toast 的混用
   - 标签页使用“就地提示（info bar）”，保证同一时刻只出现一条提示
2. **精简显示按钮**
   - 悬停提示改为：`精简显示：已关闭/已开启（长按打开精简显示设置）`，并随状态变化
   - 点击切换后按钮高亮更明显（深色态）
3. **会话管理按钮**
   - 悬停提示改为：`会话管理（长按可显示标签页）`
   - 长按折叠/展开标签页不再弹出浮动提示
4. **标签页提示整改**
   - 标签提示文案改为：`鼠标左键长按进行重命名`
   - 关闭监听（×）悬停提示文案：`关闭监听`
   - 移除“标签弹出浮动信息”类提示叠加
5. **会话管理抽屉布局与提示**
   - 移除“点击：切换会话”等浮动/悬停提示
   - 导出按钮支持 4 种状态角标：原生/闪电/地球/闪电+地球
6. **精简显示弹层 UI**
   - 调整为 `完美精简显示ui.png` 的行样式与勾选符号表现
7. **顶部状态栏移除**
   - 移除开头右上角状态栏显示（保留必要按钮与主标题）
8. **导出设置弹层整改**
   - 修复层级（导出设置不被会话管理遮挡）
   - 移除冗余“当前会话”信息行
   - 导出按钮提示文案：`导出（长按设置）`
9. **会话信息展示**
   - 不再显示原始文件名（如 `rollout-...`）
   - 提示文案改为：`长按可复制对话 JSON 源文件路径`（可在实现中进一步精简）

## 影响范围

- **模块:** `ui/`（前端界面与交互）
- **主要文件（预估）:**
  - `ui/index.html`
  - `ui/styles.css`
  - `ui/app/view_mode.js`
  - `ui/app/control/ui.js`
  - `ui/app/control/wire.js`
  - `ui/app/sidebar/tabs.js`
  - `ui/app/quick_view_settings.js`
  - `ui/app/dom.js`
  - `ui/app/control/load.js`

## 核心场景

### 需求: 1 精简信息按钮
**模块:** 右侧操作栏

#### 场景: 悬停提示与状态同步
- 悬停仅出现一条信息栏
- 文案为 `精简显示：已关闭/已开启（长按打开精简显示设置）`，且“已关闭/已开启”随点击切换同步

#### 场景: 点击切换高亮明显
- 点击切换后按钮呈现更明显的深色高亮态

### 需求: 2 会话管理按钮
**模块:** 右下角浮动菜单

#### 场景: 悬停提示
- 悬停显示 `会话管理（长按可显示标签页）`

#### 场景: 长按不再弹浮动提示
- 长按折叠/展开标签页不弹出 toast 类提示

### 需求: 3-5 标签提示
**模块:** 底部会话标签栏

#### 场景: 标签信息
- 标签悬停显示 `鼠标左键长按进行重命名`

#### 场景: 关闭监听提示
- 悬停在 × 上只显示 `关闭监听`（不叠加其他提示）

### 需求: 6 会话管理内部布局
**模块:** 会话管理抽屉

#### 场景: 无“切换会话”提示
- 不再出现 `点击：切换会话` 等提示

#### 场景: 导出按钮 4 状态角标
- 仅一个导出按钮，角标按导出设置组合展示：
  - 原生导出（无角标）
  - 闪电标（精简导出）
  - 地球标（包含译文）
  - 闪电 + 地球（同时启用）

### 需求: 7 精简显示弹层样式
**模块:** 精简显示设置弹层

#### 场景: 行样式对齐配图
- 列表为整块面板 + 分割线
- 勾选符号样式与选中行的高亮边框符合配图

### 需求: 8 顶部状态栏移除
**模块:** 顶部栏

#### 场景: 去掉状态栏
- 顶部不再展示“监听/会话/翻译/精简”等状态汇总条

### 需求: 9-10 导出设置与提示
**模块:** 导出设置弹层 / 导出按钮

#### 场景: 导出设置层级与内容
- 导出设置始终在最上层，不被会话管理抽屉遮挡
- 不展示“当前会话”冗余信息
- 选项右侧显示顺序为 `精简/全量`、`译文/原文`

#### 场景: 导出按钮提示文案
- 悬停提示为 `导出（长按设置）`

### 需求: 11 切换会话提示移除
**模块:** 会话管理抽屉

#### 场景: 不出现“点击切换会话”
- 抽屉列表不出现“点击：切换会话”等提示文案

### 需求: 12 会话信息页面
**模块:** 会话管理抽屉

#### 场景: 不显示原始文件名
- 不显示 `rollout-...` 等原始文件名行

#### 场景: 提示复制 JSON 路径
- 使用更精简的提示文案表达：长按可复制对话 JSON 源文件路径

## 风险评估

- **风险:** 提示系统统一可能影响现有可用性与可访问性（hover/焦点提示、触控设备行为）
- **缓解:**
  - 统一依赖 `aria-label` 与可见 focus 样式，避免 `title` 与 toast 混用
  - 针对 coarse pointer（触控）保持足够点击热区与不依赖 hover 的关键信息
  - 每完成一次“大改动”进行一次 `git commit`，便于回滚与审阅

